---
title: "Untitled"
output: pdf_document
date: "2023-11-29"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

1.  

```{r}
library(rvest)
library(dplyr)
library(polite)

url <- "https://www.imdb.com/chart/toptv/?ref_=nv_tvv_250"

session <- bow(url,user_agent = "Educational Purposes")
session

```

1.  

```{r}
library(rvest)
title <- scrape(session)%>%
html_nodes("h3.ipc-title__text")%>%
html_text
title

subsettt <- as.data.frame(title[2:51])
colnames(subsettt) <- "title"
split_df <- strsplit(as.character(subsettt$ranks), ".", fixed = TRUE )
split_df<- data.frame(do.call(rbind, subsettt))
subsettt




  

```
1.
```{r}

votec <- scrape(session) %>%
  html_nodes("span.ipc-rating-star--voteCount") %>%
  html_text
subvote <- as.data.frame(votec[1:50])
colnames(subvote) <- "votecount"
split_df2 <- strsplit(as.character(subvote$voteCount), ".", fixed = TRUE )
split_df2 <- data.frame(do.call(rbind, subrate))
subvote

```


1.  

```{r}
library(rvest)
library(stringr)
rate <- scrape(session) %>%
  html_nodes("span.ipc-rating-star--imdb")  %>%
html_attr("aria-label")
rate

rate_sub<- as.data.frame(rate[2:51])
head(rate_sub)
colnames(rate_sub) <- "rate"
split_df <- strsplit(as.character(rate_sub$rate),".",fixed = TRUE)
split_df <- data.frame(do.call(rbind,split_df))


head(rate_sub)




```

1.  extract ratings

```{r}
ratesubs<- str_extract(rate_sub$rate, "\\d+\\.\\d+")
ratesubs

```
1.Temporary data frame
```{r}
wedata <- data.frame(
  Title = subsettt,
  Rate = ratesubs,
  Vote_count = voteCount
)
wedata
```
1. number of episodes
```{r}
year <- scrape(session)%>%
  html_nodes("span.sc-479faa3c-8.bNrEFi.cli-title-metadata-item") %>%
  html_text
year


  

```

#___________________________SALINAS________________
4. Select 3 products from Amazon of the same category. Extract the price, description, ratings and
reviews of each product.

```{r}
# Install and load required packages

library(rvest)
library(dplyr)
library(httr) 
library(xml2)
library(purrr)
library(stringr)



product1 <- read_html("https://www.amazon.com/dp/B07KRY43KN/ref=s9_acsd_al_bw_c2_x_2_i?pf_rd_m=ATVPDKIKX0DER&pf_rd_s=merchandised-search-4&pf_rd_r=GZGJJ856P8VPY486DVX2&pf_rd_t=101&pf_rd_p=b48f1b52-3d78-40aa-8e5b-0e5b1e8f2dba&pf_rd_i=21217035011")

product2 <- read_html("https://www.amazon.com/dp/B01EZV35QU/ref=s9_acsd_al_bw_c2_x_9_i?pf_rd_m=ATVPDKIKX0DER&pf_rd_s=merchandised-search-4&pf_rd_r=GZGJJ856P8VPY486DVX2&pf_rd_t=101&pf_rd_p=b48f1b52-3d78-40aa-8e5b-0e5b1e8f2dba&pf_rd_i=21217035011")

product3 <- read_html("https://www.amazon.com/dp/B099WTN2TR/ref=s9_acsd_al_bw_c2_x_6_i?pf_rd_m=ATVPDKIKX0DER&pf_rd_s=merchandised-search-4&pf_rd_r=GZGJJ856P8VPY486DVX2&pf_rd_t=101&pf_rd_p=b48f1b52-3d78-40aa-8e5b-0e5b1e8f2dba&pf_rd_i=21217035011")


```

```{r}
# ALL COMBINED DATA IN ONE FRAME
combined_data <- cbind( Price,result_df, ratings_data, reviews_df)

print("Combined Data:")
print(combined_data)
```


#----------------------------------------------------

     PRICE
#___________________________________________________


PRICE 1,2 and 3
```{r}
product1 %>% 
    html_nodes("span.a-offscreen") %>% 
    html_text() ->  price1

first_column <- price1[1]

first_column <- price1[[1]]

print(first_column)

#..........................................

product2 %>% 
    html_nodes("span.a-offscreen") %>% 
    html_text() ->  price2

first_column2 <- price2[1]

first_column2 <- price2[[1]]

print(first_column2) 

#........................................

product3 %>% 
    html_nodes("span.a-offscreen") %>% 
    html_text() ->  price3


first_column3 <- price3[1]

first_column3 <- price3[[1]]

print(first_column3) 

#............................................

Price <-data.frame(
   Price = c(first_column, first_column2, first_column3)
)

print(Price)


```

